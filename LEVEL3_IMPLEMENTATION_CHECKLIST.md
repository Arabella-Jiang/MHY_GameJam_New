# Level 3: 星之闪耀【雪】- 技术实现清单

## 1. 核心系统扩展

### 1.1 ObjectProperty.cs 扩展
- [ ] 添加 `Heavy` 特性（重）
- [ ] 添加 `Cool` 特性（凉）
- [ ] 添加 `White` 特性（白）
- [ ] 添加 `Transparent` 特性（透）
- [ ] 添加 `Sharp` 特性（尖）

### 1.2 资源管理系统
- [ ] 创建 `WaterResource.cs` 资源类
- [ ] 实现资源获取逻辑
- [ ] 实现资源使用逻辑
- [ ] 在Player或PlayerHoldItem中添加资源管理

## 2. 组合效果组件

### 2.1 IceConeHardEffect.cs
- [ ] 继承 `CombinationEffect`
- [ ] 实现 `TriggerEffect()` 方法
- [ ] 检测冰锥是否获得Hard属性
- [ ] 实现凿开结冰湖面的逻辑
- [ ] 生成湖水资源

### 2.2 PlayerHeavyEffect.cs
- [ ] 继承 `CombinationEffect` 或创建新组件
- [ ] 检测玩家是否获得Heavy属性
- [ ] 修改PlayerMovement的重力或质量
- [ ] 实现压裂冰面的检测逻辑
- [ ] 生成湖水资源

### 2.3 IceConeLensEffect.cs
- [ ] 继承 `CombinationEffect`
- [ ] 实现冰锥打磨逻辑（可能需要新的交互方式）
- [ ] 实现凸透镜效果（汇聚光线）
- [ ] 实现融化冰雪的逻辑
- [ ] 生成水资源

### 2.4 SnowMirrorEffect.cs
- [ ] 继承 `CombinationEffect`
- [ ] 检测雪面是否同时拥有Hard和Transparent属性
- [ ] 实现镜面效果（改变材质或添加反射组件）
- [ ] 实现星光反射检测
- [ ] 触发"星点"组件收集

### 2.5 StoneTransparentEffect.cs
- [ ] 继承 `CombinationEffect`
- [ ] 检测大块石头是否获得Transparent属性
- [ ] 实现透明/反射效果
- [ ] 实现星光映射检测
- [ ] 触发"星点"组件收集

### 2.6 PlantRevivalEffect.cs
- [ ] 继承 `CombinationEffect` 或创建新组件
- [ ] 检测枯死植物是否获得水/湖水
- [ ] 实现植物复活动画
- [ ] 播放过场动画
- [ ] 触发"生"组件收集

### 2.7 StarTabletEffect.cs
- [ ] 继承 `CombinationEffect`
- [ ] 检测石碑是否获得"生"和"星点"组件
- [ ] 实现石碑点亮效果
- [ ] 实现天空变亮效果
- [ ] 播放过场动画
- [ ] 触发关卡完成

## 3. 收集组件

### 3.1 LifeCollector.cs
- [ ] 参考 `FeatherCollector.cs` 实现
- [ ] 标记"生"组件
- [ ] 在植物复活时触发
- [ ] 通知Level3Manager

### 3.2 StarPointCollector.cs
- [ ] 参考 `FeatherCollector.cs` 实现
- [ ] 标记"星点"组件
- [ ] 在星光反射时触发
- [ ] 通知Level3Manager

## 4. 关卡管理器

### 4.1 Level3Manager.cs
- [ ] 继承 `LevelManager`
- [ ] 实现 `HandlePlayerPickup()` 方法
- [ ] 实现 `HandlePlayerUse()` 方法
- [ ] 跟踪"生"组件收集状态
- [ ] 跟踪"星点"组件收集状态
- [ ] 实现石碑充能逻辑
- [ ] 实现关卡完成逻辑
- [ ] 管理过场动画触发

## 5. 交互系统扩展

### 5.1 属性选择系统
- [ ] 修改 `Player.cs` 中的属性理解逻辑
- [ ] 当物体有多个属性时显示选择UI
- [ ] 实现属性选择UI（数字键选择）
- [ ] 添加提示文本："该物体有多种特性,请选择一种最符合需求的并继续探索吧"

### 5.2 自我赋能系统
- [ ] 修改 `EmpowermentAbility.cs` 支持自我赋能
- [ ] 修改 `Player.cs` 支持对自身使用属性
- [ ] 实现玩家自身属性效果（如变重）

### 5.3 多重属性赋予系统
- [ ] 修改 `InteractableObject.cs` 支持多个属性组合
- [ ] 修改 `CheckPropertyCombinations()` 支持多重属性检测
- [ ] 确保组合效果正确触发

### 5.4 资源使用系统
- [ ] 在 `Player.cs` 中添加资源使用逻辑
- [ ] 实现对着物体使用资源的交互
- [ ] 实现资源消耗逻辑

## 6. UI系统

### 6.1 初始UI文本
- [ ] 创建UI文本显示系统
- [ ] 实现关卡开始时的文本显示
- [ ] 文本："春,多么充满希望的字。万物复苏,草木葳蕤,知春便知世界的律动。"

### 6.2 最终UI文本
- [ ] 实现关卡完成时的文本显示
- [ ] 文本："星星,照应我们所处的位置在宇宙的何方,知道脚下在哪里,才明白未来何去何从。"

### 6.3 交互提示UI
- [ ] 实现属性选择提示UI
- [ ] 实现资源使用提示UI
- [ ] 优化现有交互UI显示

## 7. 视觉效果

### 7.1 萤火虫效果
- [ ] 创建萤火虫Prefab
- [ ] 实现萤火虫环绕物体飞行的逻辑
- [ ] 将萤火虫添加到可交互物体周围
- [ ] 将萤火虫添加到枯死植物周围
- [ ] 实现萤火虫光源效果

### 7.2 植物复苏效果
- [ ] 创建植物复苏动画
- [ ] 实现植物状态切换（枯死→生机）
- [ ] 添加粒子效果（可选）
- [ ] 播放过场动画

### 7.3 星光反射效果
- [ ] 实现镜面反射效果
- [ ] 实现星光投影效果
- [ ] 检测星光反射
- [ ] 触发"星点"组件收集

### 7.4 石碑激活效果
- [ ] 实现石碑点亮效果
- [ ] 实现字体逐渐点亮效果
- [ ] 添加光源效果
- [ ] 播放过场动画

### 7.5 天空变亮效果
- [ ] 实现天空亮度变化
- [ ] 实现星星变亮效果
- [ ] 播放过场动画

## 8. 过场动画

### 8.1 植物复苏过场
- [ ] 创建过场动画序列
- [ ] 实现镜头切换
- [ ] 实现植物复苏动画
- [ ] 添加音效（可选）

### 8.2 石碑激活过场
- [ ] 创建过场动画序列
- [ ] 实现镜头切换到石碑
- [ ] 实现石碑点亮动画
- [ ] 添加音效（可选）

### 8.3 天空变亮过场
- [ ] 创建过场动画序列
- [ ] 实现镜头切换到天空
- [ ] 实现星星变亮动画
- [ ] 添加音效（可选）

## 9. 场景搭建

### 9.1 Level3场景
- [ ] 创建Level3.unity场景
- [ ] 添加雪山环境
- [ ] 添加石碑
- [ ] 添加枯死植物
- [ ] 添加结冰湖面
- [ ] 添加冰面
- [ ] 添加可交互物体（石头、雪、冰锥）
- [ ] 配置光照（夜晚、星光）
- [ ] 添加Player Prefab
- [ ] 添加Level3Manager

### 9.2 Prefab创建
- [ ] 创建枯死植物Prefab
- [ ] 创建结冰湖面Prefab
- [ ] 创建冰面Prefab
- [ ] 创建大块石头Prefab
- [ ] 创建Level3石碑Prefab
- [ ] 创建萤火虫Prefab
- [ ] 创建湖水资源Prefab（如果需要）

## 10. 音效系统（可选）

### 10.1 环境音效
- [ ] 风声
- [ ] 雪声
- [ ] 夜晚环境音

### 10.2 交互音效
- [ ] 凿冰声
- [ ] 植物复苏声
- [ ] 石碑激活声
- [ ] 星光反射声

### 10.3 背景音乐
- [ ] 关卡背景音乐
- [ ] 过场动画音乐

## 11. 测试清单

### 11.1 功能测试
- [ ] 测试所有新特性理解功能
- [ ] 测试所有新特性赋予功能
- [ ] 测试所有组合效果触发
- [ ] 测试资源获取和使用
- [ ] 测试组件收集
- [ ] 测试石碑充能
- [ ] 测试关卡完成

### 11.2 交互测试
- [ ] 测试属性选择UI
- [ ] 测试多重属性赋予
- [ ] 测试自我赋能
- [ ] 测试资源使用

### 11.3 视觉效果测试
- [ ] 测试萤火虫效果
- [ ] 测试植物复苏动画
- [ ] 测试星光反射效果
- [ ] 测试石碑激活效果
- [ ] 测试天空变亮效果

### 11.4 过场动画测试
- [ ] 测试植物复苏过场
- [ ] 测试石碑激活过场
- [ ] 测试天空变亮过场

### 11.5 性能测试
- [ ] 测试萤火虫性能
- [ ] 测试粒子效果性能
- [ ] 测试反射效果性能
- [ ] 优化性能问题

## 12. 文档更新

### 12.1 代码文档
- [ ] 更新 `PROJECT_ANALYSIS.md`
- [ ] 更新 `COMPONENT_RELATIONS.md`
- [ ] 添加新组件的文档注释

### 12.2 设计文档
- [ ] 更新关卡设计文档
- [ ] 更新交互设计文档
- [ ] 更新视觉效果设计文档

## 13. 开发顺序建议

### 第一阶段：核心系统
1. 扩展ObjectProperty枚举
2. 实现Level3Manager基础框架
3. 实现获得"生"组件的路径1（最简单）
4. 实现获得"星点"组件的路径1（最简单）
5. 实现石碑激活基础逻辑

### 第二阶段：完整功能
1. 实现其他获得组件的路径
2. 实现资源管理系统
3. 实现属性选择系统
4. 实现自我赋能系统
5. 实现多重属性赋予系统

### 第三阶段：视觉效果
1. 实现基础视觉效果
2. 实现萤火虫效果
3. 实现植物复苏效果
4. 实现星光反射效果
5. 实现石碑激活效果

### 第四阶段：Polish
1. 实现过场动画
2. 添加音效
3. 优化UI
4. 性能优化
5. 细节调整

## 14. 注意事项

1. **兼容性**: 确保新特性与现有系统兼容
2. **扩展性**: 确保系统易于扩展新的路径和效果
3. **性能**: 注意视觉效果的性能影响
4. **用户体验**: 确保引导清晰，玩家能够理解如何获得组件
5. **平衡性**: 确保多条路径的难度相对平衡
6. **测试**: 充分测试所有功能，确保没有bug

